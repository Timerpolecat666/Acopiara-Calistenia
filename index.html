<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Acopiara Calistenia ‚Äî Cronograma</title>
  <link rel="icon" href="assets/images/dumbell.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .fade-in { animation: fade 0.6s ease-in; }
    @keyframes fade { from { opacity: 0; transform: translateY(6px);} to { opacity:1; transform:none;} }
  </style>
</head>
<body class="bg-slate-900 text-slate-100 antialiased">
  <div id="root"></div>

  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Firebase compat -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBWh9FOM2VHkenakxccSauyPkcBXSMZ-AQ",
      authDomain: "acopiara-calistenia.firebaseapp.com",
      projectId: "acopiara-calistenia",
      storageBucket: "acopiara-calistenia.appspot.com",
      messagingSenderId: "78878692910",
      appId: "1:78878692910:web:5a334cf12e7b84be5f71bf"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <script>
    const { useState, useEffect, createElement: h } = React;

    function App() {
      const users = ['Erick', 'Gabriel', 'Brendo', 'Jonas', 'Leonardo'];
      const days = ['Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta'];

      const [schedule, setSchedule] = useState({});
      const [saving, setSaving] = useState(false);

      useEffect(() => {
        const unsub = db.collection('cronograma').doc('semana-atual').onSnapshot(doc => {
          if (doc.exists) setSchedule(doc.data());
          else {
            const init = {};
            users.forEach(u => {
              init[u] = {};
              days.forEach(d => init[u][d] = { text: '', status: 'none' });
            });
            db.collection('cronograma').doc('semana-atual').set(init);
          }
        });
        return () => unsub();
      }, []);

      const save = (data) => {
        setSaving(true);
        db.collection('cronograma').doc('semana-atual').set(data)
          .then(() => setSaving(false));
      };

      const updateText = (u, d, v) => {
        const next = structuredClone(schedule);
        next[u][d].text = v;
        setSchedule(next);
        save(next);
      };

      const toggleStatus = (u, d, s) => {
        const next = structuredClone(schedule);
        next[u][d].status = next[u][d].status === s ? 'none' : s;
        setSchedule(next);
        save(next);
      };

      if (!Object.keys(schedule).length)
        return h('div', { className: 'p-10 text-center fade-in' }, 'Carregando cronograma‚Ä¶');

      return h('div', { className: 'max-w-7xl mx-auto fade-in' },

        /* BANNER */
        h('div', { className: 'relative h-64 rounded-b-3xl overflow-hidden shadow-lg' },
          h('img', { src: 'assets/images/banner.jpg', className: 'absolute inset-0 w-full h-full object-cover opacity-40' }),
          h('div', { className: 'absolute inset-0 bg-gradient-to-b from-slate-900/80 to-slate-900' }),
          h('div', { className: 'relative z-10 h-full flex flex-col justify-center px-6' },
            h('div', { className: 'flex items-center gap-3' },
              h('img', { src: 'assets/images/dumbell.png', className: 'w-14 h-14' }),
              h('h1', { className: 'text-3xl font-bold' }, 'Acopiara Calistenia')
            ),
            h('p', { className: 'mt-2 text-slate-300 italic' }, 'Consist√™ncia vence motiva√ß√£o.')
          )
        ),

        /* STATUS */
        h('div', { className: 'px-6 py-3 text-sm text-slate-400' }, saving ? 'üîÑ Salvando altera√ß√µes‚Ä¶' : '‚úÖ Tudo salvo'),

        /* GRID DESKTOP */
        h('div', { className: 'hidden md:block px-6' },
          h('table', { className: 'w-full border-collapse mt-4' },
            h('thead', null,
              h('tr', { className: 'bg-slate-800 text-xs uppercase' },
                h('th', { className: 'p-3 border border-slate-700' }, 'Atleta'),
                ...days.map(d => h('th', { key: d, className: 'p-3 border border-slate-700' }, d))
              )
            ),
            h('tbody', null,
              users.map(u => h('tr', { key: u },
                h('td', { className: 'p-3 font-medium text-emerald-400 border border-slate-700' }, u),
                ...days.map(d => h('td', { key: d, className: 'p-2 border border-slate-700' },
                  h('textarea', {
                    className: 'w-full h-20 bg-transparent border border-slate-600 rounded p-2 text-sm focus:ring-2 focus:ring-emerald-500',
                    value: schedule[u][d].text,
                    onChange: e => updateText(u, d, e.target.value)
                  }),
                  h('div', { className: 'flex gap-1 justify-end mt-1' },
                    h('button', { onClick: () => toggleStatus(u, d, 'completed') }, '‚úÖ'),
                    h('button', { onClick: () => toggleStatus(u, d, 'partial') }, '‚ö†Ô∏è'),
                    h('button', { onClick: () => toggleStatus(u, d, 'missed') }, '‚ùå')
                  )
                ))
              ))
            )
          )
        ),

        /* MOBILE CARDS */
        h('div', { className: 'md:hidden px-4 space-y-4' },
          users.map(u => h('div', { key: u, className: 'bg-slate-800 rounded-xl p-4 shadow' },
            h('h2', { className: 'text-emerald-400 font-semibold mb-2' }, u),
            days.map(d => h('div', { key: d, className: 'mb-3' },
              h('div', { className: 'text-xs text-slate-400 mb-1' }, d),
              h('textarea', {
                className: 'w-full h-16 bg-slate-900 border border-slate-600 rounded p-2 text-sm',
                value: schedule[u][d].text,
                onChange: e => updateText(u, d, e.target.value)
              }),
              h('div', { className: 'flex gap-2 justify-end mt-1' },
                h('button', { onClick: () => toggleStatus(u, d, 'completed') }, '‚úÖ'),
                h('button', { onClick: () => toggleStatus(u, d, 'partial') }, '‚ö†Ô∏è'),
                h('button', { onClick: () => toggleStatus(u, d, 'missed') }, '‚ùå')
              )
            ))
          ))
        )
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(h(App));
  </script>
</body>
</html>
